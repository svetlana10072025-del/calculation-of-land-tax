# .github/workflows/warmup.yml
name: üî• –ü—Ä–æ–≥—Ä–µ–≤ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–æ–≤

on:
  schedule:
    - cron: '0,30 * * * *'  # –ö–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç: 00 –∏ 30 –º–∏–Ω—É—Ç–∞ –∫–∞–∂–¥–æ–≥–æ —á–∞—Å–∞
  workflow_dispatch:

jobs:
  warmup:
    runs-on: ubuntu-latest
    steps:
    - name: üî• –ü—Ä–æ–≥—Ä–µ–≤ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–æ–≤
      run: |
        echo "=== –ù–ê–ß–ê–õ–û –ü–†–û–ì–†–ï–í–ê ==="
        echo "–í—Ä–µ–º—è: $(date '+%H:%M:%S')"
        echo ""
        
        CALCULATORS=(
          "https://calculation-of-land-tax-4sx2mxfrtshecl77uvz7l6.streamlit.app/"
          "https://calculation-eco-tax-xfu9rozazao4heudm3p6gz.streamlit.app/"
          "https://calculation-of-excise-bnrlk8d8pnf4wpwhwvnpfj.streamlit.app/"
          "https://calculation-of-mining-tax-jvospomyc4pgvpy8ubrrrw.streamlit.app/"
          "https://calculation-of-oil-tax-fsdt98ampwhs5pzpfzuhsy.streamlit.app/"
          "https://calculation-of-tax-bfapeep5eknsp2xxs5kfij.streamlit.app/"
        )
        
        SUCCESS_COUNT=0
        TOTAL_COUNT=${#CALCULATORS[@]}
        
        for url in "${CALCULATORS[@]}"; do
          echo "üîÑ –ü—Ä–æ–≥—Ä–µ–≤–∞–µ–º: $(echo $url | cut -d'/' -f3)"
          
          TIMESTAMP=$(date +%s)
          FULL_URL="${url}?warmup=${TIMESTAMP}&from=github"
          
          HTTP_CODE=$(curl -L -s -o /dev/null \
               -w "%{http_code}" \
               -m 25 \
               --retry 2 \
               --retry-delay 1 \
               --user-agent "Mozilla/5.0 (GitHub Actions)" \
               "$FULL_URL")
          
          if [ "$HTTP_CODE" = "200" ] || [ "$HTTP_CODE" = "201" ]; then
            echo "‚úÖ HTTP $HTTP_CODE"
            ((SUCCESS_COUNT++))
          else
            echo "‚ö†Ô∏è  HTTP $HTTP_CODE"
          fi
          
          echo "---"
          sleep 2
        done
        
        echo "=== –ü–†–û–ì–†–ï–í –ó–ê–í–ï–†–®–ï–ù ==="
        echo "–†–µ–∑—É–ª—å—Ç–∞—Ç: $SUCCESS_COUNT/$TOTAL_COUNT"
